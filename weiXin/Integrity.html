<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name = "format-detection" content = "telephone=no">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>我的PU</title>
    <link href="bower_components/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/reset.css" rel="stylesheet">
</head>
<body>
<!--头部说明-->
<div class="w-head">
	<img src="img/back.png" class="w-back" onclick="history.back(-1)">
	<span>我的诚信值</span>
	<a href="#" class="w-home"><img src="img/home.png"></a>
</div>
<div>
    <header class="integrity-header">
        <p>25%</p>
        <p>当前诚信值</p>
    </header>
    <div class="integrity-num clearfix">
        <div class="integrity-total">
            <p class="integrity-event-num">15</p>
            <p class="integrity-title">得分次数</p>
        </div>
        <div class="integrity-signed">
            <p class="integrity-event-num">10</p>
            <p class="integrity-title">扣分次数</p>
        </div>
    </div>
    <div class="integrity-list">
    	<p>明细</p>
        <ul>
            <li class="to-event" data-eventid="">
				<div>
					<div class="integrity-school pull-left">
                        <p>大学生艺术节比赛活动大学生艺术节比赛活动大学生艺术节比赛活动</p>
                    </div>
                    <div class="integrity-event-point pull-right">
                        <p class="integrity-event-signed">已签到</p>
                    </div>
                    <p class="integrity-date pull-left">2015-09-28</p>
				</div>
            </li>
            <li class="to-event" data-eventid="">
				<div>
					<div class="integrity-school pull-left">
	                    <p>大学生艺术节比赛活动大学生艺术节比赛活动大学生艺术节比赛活动</p>
	                </div>
	                <div class="integrity-event-point pull-right">
	                    <p class="integrity-event-nget">未获得</p>
	                </div>
	                <p class="integrity-reason pull-left">原因：打卡失败了你要重新打卡啊</p>
	                <p class="integrity-date pull-left">2015-09-28</p>
				</div>
            </li>
            <li class="to-event" data-eventid="">
				<div>
					<div class="integrity-school pull-left">
	                    <p>大学生艺术节比赛活动大学生艺术节比赛活动大学生艺术节比赛活动</p>
	                </div>
	                <div class="integrity-event-point liked pull-right">
	                	<p class="integrity-event-signed">已签到</p>
	                </div>
	                <p class="integrity-date pull-left">2015-09-28</p>
				</div>
            </li>
        </ul>
    </div>
    <!--<button class="L-complain">申诉</button>-->
</div>
</body>
<script src="bower_components/jquery/dist/jquery.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script>
	var page=1;
	var loadingStr = '<div class="spinner"><div class="spinner-container container1"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container2"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container3"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div></div>';
	var noneStr = '<div class="nonestr">没有记录</div>';
	var loadingShow = false;
	var html = $(".integrity-list ul").html();
	$(function () {
		getdata();
	});
	
	function getdata(){
		if (!loadingShow) {
			$(".integrity-list ul").append(loadingStr);
			loadingShow = true;
			getAjaxNews();
		}
	
	}
		
	$(window).scroll(function(){
		var document = window.document;
		var top = document.body.scrollTop || document.documentElement.scrollTop
				|| 0;
		top += document.documentElement.clientHeight;
		var height = document.documentElement.scrollHeight;
		if (height - top < 1000) {
			if (!loadingShow) {
				$(".integrity-list ul").append(loadingStr);
				loadingShow = true;
				getAjaxNews();
			}
		}
	});
	
	function getAjaxNews() {
			$.ajax({
				url: "#",
				//type: 'get',
				data: {
					page: page
				},
				error: function () {
				},
				success: function (data) {
					//if (data!='0') {
						$(".spinner").hide();
					    $(".integrity-list ul").append(html);
					//	$(".square_comment_list").append(data);
						$(".spinner").remove();
						page++;
						loadingShow = false;
					//} else {
					//	$(".spinner").hide();
					//	$(".square_comment_list").append(noneStr);
					//	$(".spinner").remove();
					//}
				}
			});
	}

</script>
</html>
